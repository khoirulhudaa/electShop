import{k as y,r as c,u as N,i as C,j as e,L as S,c as B}from"./index-c43d25d1.js";import{N as E,i as T,j as F,a as q}from"./index-61f77665.js";import{c as I,a as m,b as M,I as l,B as g,S as P}from"./index-75ae6465.js";import{w as R}from"./sweetalert2-react-content.es-a297bc4b.js";import{B as k}from"./bgProfile-c213daa8.js";import{A as b}from"./api-273c7fe6.js";import{u as z}from"./formik.esm-daee778b.js";import{u as Y}from"./useDispatch-e360369d.js";const D=({onError:u,onResponse:x})=>{const o=new AbortController().signal,r=y.getState().authReducer.auth,h=z({initialValues:{consumer_name:"",email_consumer:"",telephone_consumer:"",gender:"",consumer_image:null,post_code:0,address:"",consumer_image_old:null},validationSchema:I({consumer_name:m().max(15,"Must be 15 characters or less").required("This field is required."),email_consumer:m().email("Invalid email address").required("This field is required."),telephone_consumer:m().max(13,"Maximum only 13 characters").required("This field is required."),gender:m().required("This field is required.").oneOf(["Male","Female"],"Invalid gender"),address:m().notRequired(),post_code:m().max(5,"Maximum only 4 number").notRequired(),consumer_image:M().test("fileType","Only JPG and PNG",n=>{if(!n)return!0;const d=["image/jpeg","image/png"],a=n.type;return d.includes(a)}).test("fileSize","Maximal size is 2MB.",n=>n?n.size<=2*1024*1024:!0).notRequired()}),onSubmit:async(n,{resetForm:d})=>{try{if(o.aborted)return;const a=new FormData;a.append("consumer_name",n.consumer_name),a.append("email_consumer",n.email_consumer),a.append("gender",n.gender),a.append("post_code",n.post_code),a.append("address",n.address),a.append("telephone_consumer",n.telephone_consumer),n.consumer_image&&n.consumer_image!==null&&a.append("consumer_image",n.consumer_image);const i=await b.updateAccountConsumer({consumer_id:(r==null?void 0:r.consumer_id)||"",body:a});i.data.status===200?(x(i.data.message),d()):u(i.data.message)}catch(a){u(a.data.message)}}});return c.useEffect(()=>{h.setValues({consumer_name:r?r.consumer_name:"",email_consumer:r?r.email_consumer:"",telephone_consumer:r?r.telephone_consumer:"",gender:r?r.gender:"",consumer_image_old:r?r.consumer_image:null,post_code:r?r.post_code:0,address:r?r.address:""})},[r]),h},H=()=>{const u=N(),[x,f]=c.useState(""),[o,r]=c.useState(!1),[h,n]=c.useState(!1),d=Y(),a=C(t=>t.authReducer.auth),i=R(P),_=()=>{i.fire({title:"Confirmation",text:"Are you sure you want to log out",icon:"question",showCancelButton:!0,confirmButtonText:"Yes",cancelButtonText:"Cancel"}).then(t=>{t.isConfirmed&&u("/signin")})};c.useEffect(()=>{(async()=>{try{const p=await b.getAccountConsumerById(a==null?void 0:a.consumer_id);console.log("result:",p),d(B(p.data.data[0])),n(!1)}catch(p){console.log(p)}})()},[h,d]);const j=t=>{t==="Successfully for update data account!"&&(n(!0),r(!1))},v=t=>{f(t),console.log(x)},w=[{label:"Select Your Gender",value:""},{label:"Male",value:"Male"},{label:"Female",value:"Female"}],s=D({onError:v,onResponse:j});return e.jsxs(e.Fragment,{children:[e.jsx(E,{}),e.jsxs("section",{className:"w-screen h-max md:flex px-[20px] md:px-[50px] mt-[30px] md:mt-[60px] rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"relative rounded-lg w-full md:w-[40%] overflow-hidden bg-slate-100 h-max md:h-[500px] mb-7",children:[e.jsx(S,{to:"/",children:e.jsx("div",{className:"absolute left-[20px] top-5 z-[4] rounded-full flex bg-white items-center justify-center cursor-pointer active:scale-[0.99] shadow-md w-[40px] h-[40px] hover:brightness-[90%]",children:e.jsx(T,{size:14})})}),e.jsx("img",{src:k,alt:"bgProfile",className:"hover:scale-[110%] ease brightness-[70%] duration-300 w-full mx-auto relative h-full object-cover"}),e.jsx("div",{className:"absolute left-[50%] top-[50%] bg-white flex items-center justify-center transform translate-x-[-50%] translate-y-[-50%] z-[2] w-[150px] h-[150px] overflow-hidden rounded-full mx-auto shadow-lg order-2 border-slate-200 cursor-pointer hover:brightness-[90%] active:scale-[0.99]",children:e.jsx("img",{src:`https://huda.descode.id/uploads/${s.values.consumer_image_old}`,alt:"fotoProfile",className:"object-contain w-[96%] h-full rounded-full"})})]}),e.jsxs("div",{className:"relative w-full md:w-[60%] md:ml-[20px] h-max md:px-[20px] md:pb-[60px] rounded-lg overflow-hidden",children:[e.jsxs("div",{onClick:_,className:"absolute md:right-5 rounded-full cursor-pointer hover:brightness-[90%] flex bg-red-500 text-white items-center justify-center z-[2] active:scale-[0.99] shadow-md w-max h-[40px] flex px-5 items-center hover:brightness-[90%]",children:[e.jsx(F,{size:14}),e.jsx("p",{className:"ml-3",children:"Sign-out"})]}),e.jsx("h2",{className:"relative mt-[60px] md:mt-0 font-bold text-[26px]",children:a==null?void 0:a.consumer_name}),e.jsxs("h2",{className:"relative font-bold text-[20px]",children:["(ID: ",a==null?void 0:a.consumer_id,")"]}),e.jsx("div",{className:"w-full h-[1px] bg-slate-500 my-5"}),e.jsx("div",{className:"w-full md:flex h-max",children:e.jsxs("form",{onSubmit:s.handleSubmit,className:"md:flex",children:[e.jsxs("div",{className:"w-full md:w-1/2 h-max md:min-h-[355px] pr-5 flex flex-col justify-start",children:[e.jsx("div",{className:"mb-5",children:e.jsx(l,{value:s.values.consumer_name,name:"consumer_name",label:"Username",disabled:!o,type:"text",id:"username",onError:s.errors.consumer_name,onTouched:!!s.touched.consumer_name,onChange:s.handleChange,onBlur:s.handleBlur,placeholder:"Enter Your Name"})}),e.jsx("div",{className:"mb-5",children:e.jsx(l,{value:s.values.email_consumer,name:"email_consumer",label:"Email",disabled:!o,type:"email",id:"emailConsumer",onError:s.errors.email_consumer,onTouched:!!s.touched.email_consumer,onChange:s.handleChange,onBlur:s.handleBlur,placeholder:"Enter Your Email"})}),e.jsx("div",{className:"mb-5",children:e.jsx(l,{value:s.values.gender,name:"gender",typeInput:"select-winput",disabled:!o,options:w,label:"Gender",id:"gender",onError:s.errors.gender,onTouched:!!s.touched.gender,onChange:s.handleChange,onBlur:s.handleBlur})}),e.jsx("div",{className:"mb-5",children:e.jsx(l,{value:s.values.address,name:"address",typeInput:"textarea-input",disabled:!o,label:"Adress",id:"adress",onError:s.errors.address,onTouched:!!s.touched.address,onChange:s.handleChange,onBlur:s.handleBlur,placeholder:"Enter Your Address"})})]}),e.jsxs("div",{className:"w-full md:w-1/2 h-max md:min-h-[355px] pr-5 flex flex-col justify-start",children:[e.jsx("div",{className:"mb-5",children:e.jsx(l,{value:s.values.post_code,name:"post_code",label:"Post code",disabled:!o,type:"number",id:"postcode",onError:s.errors.post_code,onTouched:!!s.touched.post_code,onChange:s.handleChange,onBlur:s.handleBlur,placeholder:"Enter Your PostCode"})}),e.jsx("div",{className:"mb-5",children:e.jsx(l,{value:s.values.telephone_consumer,name:"telephone_consumer",disabled:!o,label:"Telephone number",id:"Telephone",onError:s.errors.telephone_consumer,onTouched:!!s.touched.telephone_consumer,onChange:s.handleChange,onBlur:s.handleBlur,placeholder:"Enter Your Number"})}),o?e.jsx("div",{className:"mb-5",children:e.jsx(l,{name:"consumer_image",type:"file",label:"Consumer image",disabled:!o,id:"consumerImage",onError:s.errors.consumer_image,onTouched:!!s.touched.consumer_image,onChange:t=>{s.setFieldValue("consumer_image",t.target.files[0])},onBlur:s.handleBlur})}):null,e.jsx("div",{className:"flex items-center",children:o?e.jsxs(e.Fragment,{children:[e.jsx(g,{typeButton:"submit",text:"Save update",status:"primary"}),e.jsx(g,{text:"Cancel",status:"delete",handleClick:()=>r(!1),style:"ml-4"})]}):e.jsx("button",{className:"shadow-lg h-max px-[20px] py-[12px] bg-blue-500 text-white rounded-lg text-center cursor-pointer hover:brightness-[96%] active:scale-[0.99] border-0 outline-0 flex items-center justify-center",onClick:()=>r(!0),children:"Edit profile"})})]})]})})]})]}),e.jsx(q,{})]})};export{H as default};
