import{k as p,g as j,l as g,r as f,i as y,j as e,L as w}from"./index-c43d25d1.js";import{N as v,i as _,a as N}from"./index-61f77665.js";import{c as C,a as m,I as o,B as k}from"./index-75ae6465.js";import{E}from"./index-dd454b2c.js";import{f as B}from"./toRupiah-23cacd66.js";import{u as P}from"./formik.esm-daee778b.js";import{A as T}from"./api-273c7fe6.js";import{u as S}from"./useDispatch-e360369d.js";const q=({onError:n})=>{const h=new AbortController().signal,x=S(),a=p.getState().authReducer.auth,l=p.getState().cartReducer.dataOrders,s=()=>l.reduce((r,c)=>r+((c==null?void 0:c.total_price)||0),0);return P({initialValues:{channelCode:"",consumer_name:"",accountNumber:0,description:"",post_code:"",address:"",amount:0,shop_id:""},validationSchema:C({consumer_name:m().min(3,"Must be at least 3 characters").required("This field is required."),description:m().min(5,"Must be at least 5 characters").required("This field is required."),post_code:m().min(5,"Must be at least 5 characters.").required("This field is required."),address:m().required("This field is required.")}),onSubmit:async(r,{resetForm:c})=>{try{if(h.aborted)return;const i={consumer_id:a==null?void 0:a.consumer_id,email_consumer:a==null?void 0:a.email_consumer,telephone_consumer:a==null?void 0:a.telephone_consumer,accountHolderName:r.consumer_name,post_code:r.post_code,address:r.address,description:r.description,accountNumber:r.accountNumber,amount:s(),channelCode:r.channelCode,products:l,shop_id:r.shop_id};console.log("data all",i);const d=await T.checkout(i);if(console.log("response checkout:",d),d.data.status===200){c(),x(j());const b=d.data.data.invoiceUrl;window.location.href=b}else n(d.data.message)}catch(i){n(i.data.message)}}})},U=()=>{const{shop_id:n}=g(),[u,h]=f.useState(""),x=y(t=>t.cartReducer.dataOrders),a=()=>x.reduce((t,r)=>t+((r==null?void 0:r.total_price)||0),0),l=t=>{h(t)},s=q({onError:l});return f.useEffect(()=>{(async()=>{try{n&&s.setFieldValue("shop_id",n)}catch(r){l(r.message),console.log(r.mesage)}})()},[]),e.jsxs(e.Fragment,{children:[u!==""?e.jsx(e.Fragment,{children:e.jsx(E,{error:u})}):null,e.jsx(v,{}),e.jsx("section",{className:"w-screen px-[60px] py-[20px] h-max flex",children:e.jsxs("div",{className:"w-full flex items-center py-[10px]",children:[e.jsx(w,{to:"/my-cart",children:e.jsx("div",{className:"rounded-full mr-3 ml-[-10px] bg-blue-500 text-white border border-slate-300 cursor-pointer active:scale-[0.98] hover:brightness-[90%] flex items-center justify-center p-1 w-[30px] h-[30px]",children:e.jsx(_,{size:14})})}),e.jsx("h2",{className:"flex text-[20px] font-bold items-center",children:"Checkout"})]})}),e.jsx("form",{onSubmit:s.handleSubmit,children:e.jsxs("section",{className:"w-screen h-max flex px-[50px] pb-[40px]",children:[e.jsxs("div",{className:"w-[70%] mr-6 px-8 py-10 rounded-lg shadow-lg bg-slate-100 border border-slate-300",children:[e.jsxs("div",{className:"w-full flex justify-between mb-8 items-center",children:[e.jsx("div",{className:"w-[48%] h-[90px] block",children:e.jsx(o,{value:s.values.consumer_name,name:"consumer_name",label:"Your name",type:"text",id:"Yourname",onError:s.errors.consumer_name,onTouched:!!s.touched.consumer_name,onChange:s.handleChange,onBlur:s.handleBlur,placeholder:"Enter your name"})}),e.jsx("div",{className:"w-[48%] h-[90px] block",children:e.jsx(o,{value:s.values.post_code,name:"post_code",label:"Post code",type:"text",id:"post_code",onError:s.errors.post_code,onTouched:!!s.touched.post_code,onChange:s.handleChange,onBlur:s.handleBlur,placeholder:"45153"})})]}),e.jsxs("div",{className:"w-full flex mt-7 item-center justify-between",children:[e.jsx("div",{className:"w-[48%] h-[90px] block",children:e.jsx(o,{value:"Jawa Barat",disabled:!0,name:"province",label:"Province",type:"text",id:"province"})}),e.jsx("div",{className:"w-[48%] h-[90px] block",children:e.jsx(o,{value:"Cirebon",disabled:!0,name:"City",label:"City/Regency",type:"text",id:"city"})})]}),e.jsx("div",{className:"w-full flex flex-col",children:e.jsx("div",{className:"w-full mt-7 h-max block",children:e.jsx(o,{value:s.values.description,name:"description",label:"Description",type:"text",typeInput:"textarea-input",id:"description",onError:s.errors.description,onTouched:!!s.touched.description,onChange:s.handleChange,onBlur:s.handleBlur,placeholder:"Enter description..."})})}),e.jsx("div",{className:"w-full flex flex-col",children:e.jsx("div",{className:"w-full mt-7 h-max block",children:e.jsx(o,{value:s.values.address,name:"address",label:"Adress",type:"text",typeInput:"textarea-input",id:"address",onError:s.errors.address,onTouched:!!s.touched.address,onChange:s.handleChange,onBlur:s.handleBlur,placeholder:"Enter address"})})})]}),e.jsxs("div",{className:"w-[30%] rounded-lg bg-slate-100 overflow-hidden shadow-lg pb-6 h-max",children:[e.jsxs("div",{className:"w-full px-[20px] flex items-center h-max py-[16px] justify-center justify-between",children:[e.jsx("h3",{className:"text-[16px] font-bold text-black",children:"Total : "}),e.jsx("h3",{className:"text-[18px] font-bold text-black",children:B(a())})]}),e.jsx(k,{typeButton:"submit",status:"primary",text:"Pay now",style:"mt-4 w-[90%] mx-auto"})]})]})}),e.jsx(N,{})]})};export{U as default};
